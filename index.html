<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./assets/css/styles.css">
    <title>Servidor de Teste</title>
</head>
<body>
    <div class="container">
        <span class="text">
            Página de Testes
        </span>
        <span class="text">
            Treino de <strong>iptables</strong> + <strong>php</strong>.
        </span>
        <img src="https://wallsdesk.com/wp-content/uploads/2016/10/Hello-Kitty-HD-Background.jpg" alt="Hello Kitty">
        <br />
        <span style="font-size: 18px; margin-bottom: 25px;">
            Liberação/Bloqueio de IP:
        </span>
        <form action="firewall.php" method="POST" style="text-align: center;">
            <div>
                <label for="ip">Selecione o IP:</label>
                <select id="ip" name="ip" type="text">
                    <option value="" selected></option>
                    <option value="192.168.10.0/24">192.168.10.0/24</option>
                    <option value="192.168.1.0/2">192.168.1.0/2</option>
                    <option value="192.168.70.132">192.168.70.132</option>
                </select>
            </div>
            <div id="id" style="margin-top: 25px;"></div>
            <div id="result" style="margin-top: 25px;"></div>
            <input type="submit" class="button-home" value="Confirmar" style="margin-top: 25px;">
        </form>
    </div>
    <script src="./assets/jquery/jquery.min.js"></script>
    <script>
        $(document).ready(function() {

            $.get("user.php", function(resultado){
                $("#id").html("Usuário do Servidor: " + resultado);
            })

            $("#ip").on("change", function() {

                var request = $.ajax({
                    url: "consulta.php",
                    type: "POST",
                    data: {"ip": $(this).val()},

                }).done(function(resposta) {

                    $("#result").html(resposta);

                    if(resposta.includes("IP encontrado")) {
                        $("#result").css("color", "green");
                    } else {
                        $("#result").css("color", "red");
                    }

                    }).fail(function(jqXHR, textStatus) {

                        $("#result").html("Request failed: " + textStatus);
                });
            });
        });
    </script>
</body>
</html>